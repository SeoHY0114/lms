<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMS ëŒ€ì‹œë³´ë“œ</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        /* í†µê³„ ì»¨í…Œì´ë„ˆ */
        .stats-row { display: flex; gap: 15px; width: 100%; max-width: 900px; margin-bottom: 20px; flex-wrap: wrap; }
        .stat-card { background: white; flex: 1; min-width: 150px; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); text-align: center; }
        .stat-card h4 { margin: 0; color: #666; font-size: 0.9rem; }
        .stat-card .value { font-size: 1.5rem; font-weight: bold; margin-top: 10px; color: #1a73e8; }
        .stat-card .unit { font-size: 0.9rem; color: #888; margin-left: 3px; }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .profile-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); width: 100%; max-width: 860px; display: flex; align-items: center; gap: 20px; margin-bottom: 20px; }
        .profile-img { width: 60px; height: 60px; border-radius: 50%; background: #eee; }
        
        .schedule-container { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); width: 100%; max-width: 860px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; }
        .status-done { background: #e8f5e9; color: #2e7d32; }
    </style>
</head>
<body>

    <div class="stats-row" id="stats-row" style="display: none;">
        <div class="stat-card">
            <h4>ì´ë‹¬ì˜ í™œë™ë¹„</h4>
            <div class="value" id="stat-fee">0</div><span class="unit">ì›</span>
        </div>
        <div class="stat-card">
            <h4>ì£¼ê°•ì‚¬</h4>
            <div class="value" id="stat-main">0</div><span class="unit">íšŒ</span>
        </div>
        <div class="stat-card">
            <h4>ë³´ì¡°ê°•ì‚¬</h4>
            <div class="value" id="stat-sub">0</div><span class="unit">íšŒ</span>
        </div>
        <div class="stat-card">
            <h4>ì—°êµ¬í™œë™</h4>
            <div class="value" id="stat-research">0</div><span class="unit">ì‹œê°„</span>
        </div>
    </div>

    <div class="profile-card" id="profile-card" style="display: none;">
        <img src="https://via.placeholder.com/60" class="profile-img">
        <div>
            <h2 id="user-name" style="margin:0">ë¡œë”© ì¤‘...</h2>
            <p id="user-role" style="margin:5px 0; color:#666">-</p>
        </div>
    </div>

    <div class="schedule-container" id="schedule-container" style="display: none;">
        <h3>ğŸ—“ï¸ ì´ë²ˆ ì£¼ êµìœ¡ ì¼ì •</h3>
        <table>
            <tbody id="schedule-list"></tbody>
        </table>
    </div>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwdHWR8STpRe3tI8ZjyiukxCiKujotM3D_kfDqQnLTz_lBNd5so3-ogbAviwJEUoAdT/exec";

        async function init() {
            const response = await fetch(GAS_URL);
            const res = await response.json();

            if (res.status === "success") {
                // í†µê³„ ë°ì´í„° ë°˜ì˜
                document.getElementById('stat-fee').innerText = res.stats.fee.toLocaleString();
                document.getElementById('stat-main').innerText = res.stats.main;
                document.getElementById('stat-sub').innerText = res.stats.sub;
                document.getElementById('stat-research').innerText = res.stats.research;

                // ìœ ì € ì •ë³´ ë°˜ì˜
                document.getElementById('user-name').innerText = res.user.name;
                document.getElementById('user-role').innerText = res.user.role;

                // ë¦¬ìŠ¤íŠ¸ ë°˜ì˜
                const list = document.getElementById('schedule-list');
                res.schedules.forEach(s => {
                    list.innerHTML += `<tr><td>${s.date}</td><td>${s.type}</td><td><span class="badge ${s.status === 'ì™„ë£Œ' ? 'status-done' : ''}">${s.status}</span></td></tr>`;
                });

                // í‘œì‹œ ì „í™˜
                document.getElementById('stats-row').style.display = 'flex';
                document.getElementById('profile-card').style.display = 'flex';
                document.getElementById('schedule-container').style.display = 'block';
            }
        }
        init();
    </script>
</body>
</html>
